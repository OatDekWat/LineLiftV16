<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Report (LIFF)</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="report.css">
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
 <style>
            body {
            /* สีพื้นหลังสีเขียวตามรูป */
            background-color: #4CC764; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }

        /* การ์ดสีขาวที่อยู่ตรงกลาง */
        .report-card {
            background-color: #FFFFFF;
            border-radius: 16px;
            padding: 2.5rem 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            filter: drop-shadow(18px -10px -46px);
            width: 100%;
            max-width: 500px; /* จำกัดความกว้างบนจอใหญ่ */
        }
        
        .report-card h2 {
            font-weight: bold;
            color: #333;
        }

        .report-card p {
            color: #6c757d; /* สีเทาของ Bootstrap */
            margin-bottom: 1.5rem;
        }

        .form-label {
            font-weight: 600;
        }

        /* ปุ่มสีเขียวตามดีไซน์ */
        .btn-brand-green {
            background-color: #06C755;
            color: white;
            font-weight: bold;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 50px; /* ทำให้ปุ่มโค้งมนสุด */
            transition: background-color 0.2s;
        }

        .btn-brand-green:hover {
            background-color: #17b04c;
            color: white;
        }

        /* ช่องกรอกข้อความ (Textarea) */
        .form-control[textarea] {
            height: 150px;
        }

        /* Placeholder text สีเทาอ่อน */
        .form-control::placeholder {
            color: #adb5bd;
        }


 </style>
<body>

    <div class="report-card">
        <form id="reportForm">
            <h2 class="text-center">รายงานประจำวัน</h2>
            <p class="text-center">กรุณากรอกข้อมูลรายงานของคุณ</p>
            
            <div class="mb-3">
                <label for="reportSubject" class="form-label">หัวข้อ</label>
                <input type_ = "text" class="form-control" id="reportSubject" placeholder="เช่น สรุปงานวันนี้" required>
            </div>
            
            <div class="mb-4">
                <label for="reportContent" class="form-label">เนื้อหารายงาน</label>
                <textarea class="form-control" id="reportContent" rows="5" placeholder="กรอกรายละเอียดงาน ปัญหาที่พบ..." required></textarea>
            </div>
            
            <div class="d-grid">
                <button type="submit" class="btn btn-brand-green">ส่งรายงาน</button>
            </div>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // รอให้หน้าเว็บโหลดเสร็จก่อน
        document.addEventListener("DOMContentLoaded", function() {
            
            // 1. **(สำคัญมาก)** ใส่ LIFF ID ของคุณตรงนี้
            // คุณต้องไปสร้าง LIFF ID ที่ LINE Developers Console
            const myLiffId = "2008417091-j2e7PZ05"; 
            
            initializeLiff(myLiffId);
        });

        // ฟังก์ชันเริ่มต้นการทำงานของ LIFF
        function initializeLiff(myLiffId) {
            liff
                .init({
                    liffId: myLiffId
                })
                .then(() => {
                    // ถ้า init สำเร็จ
                    console.log("LIFF initialized successfully.");
                    // ถ้าเปิดใน LINE ก็ให้พร้อมทำงาน
                    if (liff.isInClient()) {
                        // ผูก event กับปุ่มเมื่อ LIFF พร้อม
                        setupFormHandler();
                    } else {
                        console.log("กรุณาเปิดในแอป LINE");
                        // (Optional) คุณอาจจะซ่อน Form ถ้าไม่ได้เปิดใน LINE
                    }
                })
                .catch((err) => {
                    console.error("LIFF initialization failed:", err);
                });
        }

        // ฟังก์ชันตั้งค่าการดักจับการกดปุ่ม "ส่งรายงาน"
        function setupFormHandler() {
            const form = document.getElementById("reportForm");
            
            form.addEventListener("submit", function(event) {
                event.preventDefault(); // ป้องกันไม่ให้หน้าเว็บ Refresh
                
                // 1. ดึงค่าจากฟอร์ม
                const subject = document.getElementById("reportSubject").value;
                const content = document.getElementById("reportContent").value;
                
                if (!subject || !content) {
                    alert("กรุณากรอกข้อมูลให้ครบ");
                    return;
                }
                
                // 2. สร้างข้อความที่จะส่ง (ในรูปแบบ Text Message ของ LINE)
                // เราจะใช้ `\n` เพื่อขึ้นบรรทัดใหม่ใน LINE
                const messageText = `=== รายงานประจำวัน ===\n\nหัวข้อ: ${subject}\n\nเนื้อหา:\n${content}`;

                // 3. ส่งข้อความเข้าห้องแชทที่เปิด LIFF นี้
                if (liff.isInClient()) {
                    liff.sendMessages([
                        {
                            type: "text",
                            text: messageText
                        }
                    ])
                    .then(() => {
                        console.log("ส่งข้อความสำเร็จ!");
                        // 4. (แนะนำ) ปิดหน้าต่าง LIFF หลังจากส่งสำเร็จ
                        liff.closeWindow(); 
                    })
                    .catch((err) => {
                        console.error("ส่งข้อความไม่สำเร็จ:", err);
                        alert("เกิดข้อผิดพลาดในการส่งข้อความ");
                    });
                } else {
                    alert("ฟังก์ชันนี้ต้องทำงานในแอป LINE เท่านั้น");
                }
            });
        }
    </script>

</body>
</html>